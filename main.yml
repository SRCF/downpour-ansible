---
- name: Mattermost
  hosts: downpour
  become: yes
  tags:
    - mattermost
  vars:
    - domain: mattermost.srcf.net
    - certbot_email: soc-srcf-admin@lists.cam.ac.uk
    - mattermost_version: 5.25.0
    - mattermost_checksum: sha256:4d8053508108a2f2d33a4bfaadb821f34c20694905b14ab747a08f91fb17f801
    - mattermost_bbb_plugin_version: 2.1.0
    - mattermost_bbb_plugin_checksum: sha256:2a8b14bb22d44c4039c772b852f5499c1902f3ff6e11eb4dbd583528b5ba3e2e
    - mattermost_admin_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39643061306665306661386335376233613761653462623565653461343039616134643466616363
          3037613635643235653966373639333933303366393233640a613130356464316331643233633637
          61393130373632323462356238383563363731313039303039633636353030376131353636613136
          6638393364613762650a623263356630616331623639636138626462353634396662633163323561
          6133

    - bbb_secret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33663363643735663032643066636566653866666338326562643531306230643262666334336364
          3963346164386139656533323434666439663230646332350a316339636331663333363865303830
          65303366666366353066333461326138333732613039396238383862386637663361323235653234
          3036616438656137330a663837336637613562633333653264396166643232666432653233663234
          32633330643630393339656361306662633932613336636166656638366233323037613630376262
          62633466306336626363636532663531666162626361366230316261386366386636383064666137
          35646461303034386336643731653935656534366566396338626264636336386433373634363332
          38363966373865656530

  roles:
#    - certbot
    - mattermost

- name: Matrix bridges
  hosts: downpour
  become: yes
  tags:
    - matrix
  vars:
    - domain: matrix.srcf.net
    - certbot_email: soc-srcf-admin@lists.cam.ac.uk
    - ubuntu_version: focal
    - keyring_location: /usr/share/keyrings/matrix-org-archive-keyring.gpg
    - matrix_irc_port: 9999
    - matrix_mattermost_port: 9998
    - matrix_mattermost_webhook_port: 9898
    - matrix_irc_bridges:
       - { irc: "#town-square", matrix: "town-square" }
       - { irc: "#hackday", matrix: "hackday" }
    - matrix_mattermost_bridges:
       - "town-square"
       - "hackday"

    - matrix_botmaster_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32323735376166393135306332326562643661333362616163356661633937663033656137613766
          3661326466336139356564383832396364323138363632330a663064333938383837653237336231
          64626265626530366338653837393562303936323636333138623039383530306439393334373135
          3833323461643033390a393662313739313963386464383935653039383437356334303964626361
          3462
    - matrix_registration_secret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66396462623539633265343932383463343064633733303533356565393133656265393732323265
          3232656633333636393837363738616334653563336566390a663265613431663163376331366338
          64623461343631613462333038356136323435366263393736343232363732393833366562303361
          6636353730356636620a323633613335643062613136636530343363303336613739656239663131
          37666165333637326665396537633639633031653866356430303334336363373830663063653536
          34383733663963313538653232623834356162303061386361333032336634346630386536653462
          393730323462326536323531316165656331

  roles:
    - certbot
    - matrix-bridge
